import{r as l,c as $e,R as U,a as ge,j as c,f as Ie,d as Le,e as Ve,g as De,h as Be,i as _e,k as Ge,l as Ue}from"./index-QtTf2vBF.js";import{u as te,j as Ze,_ as qe,D as Qe,V as P,am as Je,an as be,O as ye,ao as Ke,ap as Z,aq as Xe,E as ve,aj as Me,ak as se,ad as je,al as we,ag as Ye,ah as et,ae as tt,af as st,ac as nt}from"./elements-rgb-wort-bild-Dj9Wf7YP.js";import{a as Se,u as k,O as rt}from"./hooks-CqvDGufW.js";const V=new P,ne=new P,ot=new P,fe=new Je;function at(e,t,s){const r=V.setFromMatrixPosition(e.matrixWorld);r.project(t);const o=s.width/2,n=s.height/2;return[r.x*o+o,-(r.y*n)+n]}function it(e,t){const s=V.setFromMatrixPosition(e.matrixWorld),r=ne.setFromMatrixPosition(t.matrixWorld),o=s.sub(r),n=t.getWorldDirection(ot);return o.angleTo(n)>Math.PI/2}function lt(e,t,s,r){const o=V.setFromMatrixPosition(e.matrixWorld),n=o.clone();n.project(t),fe.set(n.x,n.y),s.setFromCamera(fe,t);const a=s.intersectObjects(r,!0);if(a.length){const u=a[0].distance;return o.distanceTo(s.ray.origin)<u}return!0}function ct(e,t){if(t instanceof ye)return t.zoom;if(t instanceof be){const s=V.setFromMatrixPosition(e.matrixWorld),r=ne.setFromMatrixPosition(t.matrixWorld),o=t.fov*Math.PI/180,n=s.distanceTo(r);return 1/(2*Math.tan(o/2)*n)}else return 1}function ut(e,t,s){if(t instanceof be||t instanceof ye){const r=V.setFromMatrixPosition(e.matrixWorld),o=ne.setFromMatrixPosition(t.matrixWorld),n=r.distanceTo(o),a=(s[1]-s[0])/(t.far-t.near),u=s[1]-a*t.far;return Math.round(a*n+u)}}const ee=e=>Math.abs(e)<1e-10?0:e;function Pe(e,t,s=""){let r="matrix3d(";for(let o=0;o!==16;o++)r+=ee(t[o]*e.elements[o])+(o!==15?",":")");return s+r}const mt=(e=>t=>Pe(t,e))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),dt=(e=>(t,s)=>Pe(t,e(s),"translate(-50%,-50%)"))(e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1]);function ht(e){return e&&typeof e=="object"&&"current"in e}const xt=l.forwardRef(({children:e,eps:t=.001,style:s,className:r,prepend:o,center:n,fullscreen:a,portal:u,distanceFactor:d,sprite:i=!1,transform:m=!1,occlude:x,onOcclude:O,castShadow:b,receiveShadow:Q,material:f,geometry:T,zIndexRange:g=[16777271,0],calculatePosition:p=at,as:oe="div",wrapperClass:J,pointerEvents:ae="auto",...C},ie)=>{const{gl:le,camera:y,scene:ce,size:M,raycaster:Ee,events:ze,viewport:Fe}=te(),[v]=l.useState(()=>document.createElement(oe)),K=l.useRef(null),w=l.useRef(null),ue=l.useRef(0),D=l.useRef([0,0]),H=l.useRef(null),X=l.useRef(null),W=u?.current||ze.connected||le.domElement.parentNode,z=l.useRef(null),B=l.useRef(!1),_=l.useMemo(()=>x&&x!=="blending"||Array.isArray(x)&&x.length&&ht(x[0]),[x]);l.useLayoutEffect(()=>{const j=le.domElement;x&&x==="blending"?(j.style.zIndex=`${Math.floor(g[0]/2)}`,j.style.position="absolute",j.style.pointerEvents="none"):(j.style.zIndex=null,j.style.position=null,j.style.pointerEvents=null)},[x]),l.useLayoutEffect(()=>{if(w.current){const j=K.current=$e.createRoot(v);if(ce.updateMatrixWorld(),m)v.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const h=p(w.current,y,M);v.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${h[0]}px,${h[1]}px,0);transform-origin:0 0;`}return W&&(o?W.prepend(v):W.appendChild(v)),()=>{W&&W.removeChild(v),j.unmount()}}},[W,m]),l.useLayoutEffect(()=>{J&&(v.className=J)},[J]);const me=l.useMemo(()=>m?{position:"absolute",top:0,left:0,width:M.width,height:M.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:n?"translate3d(-50%,-50%,0)":"none",...a&&{top:-M.height/2,left:-M.width/2,width:M.width,height:M.height},...s},[s,n,a,M,m]),Ne=l.useMemo(()=>({position:"absolute",pointerEvents:ae}),[ae]);l.useLayoutEffect(()=>{if(B.current=!1,m){var j;(j=K.current)==null||j.render(l.createElement("div",{ref:H,style:me},l.createElement("div",{ref:X,style:Ne},l.createElement("div",{ref:ie,className:r,style:s,children:e}))))}else{var h;(h=K.current)==null||h.render(l.createElement("div",{ref:ie,style:me,className:r,children:e}))}});const A=l.useRef(!0);Ze(j=>{if(w.current){y.updateMatrixWorld(),w.current.updateWorldMatrix(!0,!1);const h=m?D.current:p(w.current,y,M);if(m||Math.abs(ue.current-y.zoom)>t||Math.abs(D.current[0]-h[0])>t||Math.abs(D.current[1]-h[1])>t){const F=it(w.current,y);let E=!1;_&&(Array.isArray(x)?E=x.map(N=>N.current):x!=="blending"&&(E=[ce]));const $=A.current;if(E){const N=lt(w.current,y,Ee,E);A.current=N&&!F}else A.current=!F;$!==A.current&&(O?O(!A.current):v.style.display=A.current?"block":"none");const G=Math.floor(g[0]/2),Re=x?_?[g[0],G]:[G-1,0]:g;if(v.style.zIndex=`${ut(w.current,y,Re)}`,m){const[N,he]=[M.width/2,M.height/2],Y=y.projectionMatrix.elements[5]*he,{isOrthographicCamera:xe,top:Oe,left:Te,bottom:We,right:Ae}=y,ke=mt(y.matrixWorldInverse),He=xe?`scale(${Y})translate(${ee(-(Ae+Te)/2)}px,${ee((Oe+We)/2)}px)`:`translateZ(${Y}px)`;let R=w.current.matrixWorld;i&&(R=y.matrixWorldInverse.clone().transpose().copyPosition(R).scale(w.current.scale),R.elements[3]=R.elements[7]=R.elements[11]=0,R.elements[15]=1),v.style.width=M.width+"px",v.style.height=M.height+"px",v.style.perspective=xe?"":`${Y}px`,H.current&&X.current&&(H.current.style.transform=`${He}${ke}translate(${N}px,${he}px)`,X.current.style.transform=dt(R,1/((d||10)/400)))}else{const N=d===void 0?1:ct(w.current,y)*d;v.style.transform=`translate3d(${h[0]}px,${h[1]}px,0) scale(${N})`}D.current=h,ue.current=y.zoom}}if(!_&&z.current&&!B.current)if(m){if(H.current){const h=H.current.children[0];if(h!=null&&h.clientWidth&&h!=null&&h.clientHeight){const{isOrthographicCamera:F}=y;if(F||T)C.scale&&(Array.isArray(C.scale)?C.scale instanceof P?z.current.scale.copy(C.scale.clone().divideScalar(1)):z.current.scale.set(1/C.scale[0],1/C.scale[1],1/C.scale[2]):z.current.scale.setScalar(1/C.scale));else{const E=(d||10)/400,$=h.clientWidth*E,G=h.clientHeight*E;z.current.scale.set($,G,1)}B.current=!0}}}else{const h=v.children[0];if(h!=null&&h.clientWidth&&h!=null&&h.clientHeight){const F=1/Fe.factor,E=h.clientWidth*F,$=h.clientHeight*F;z.current.scale.set(E,$,1),B.current=!0}z.current.lookAt(j.camera.position)}});const de=l.useMemo(()=>({vertexShader:m?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[m]);return l.createElement("group",qe({},C,{ref:w}),x&&!_&&l.createElement("mesh",{castShadow:b,receiveShadow:Q,ref:z},T||l.createElement("planeGeometry",null),f||l.createElement("shaderMaterial",{side:Qe,vertexShader:de.vertexShader,fragmentShader:de.fragmentShader})))}),ft=e=>e;function pt(e,t=ft){const s=U.useSyncExternalStore(e.subscribe,U.useCallback(()=>t(e.getState()),[e,t]),U.useCallback(()=>t(e.getInitialState()),[e,t]));return U.useDebugValue(s),s}const pe=e=>{const t=Ke(e),s=r=>pt(t,r);return Object.assign(s,t),s},gt=(e=>e?pe(e):pe);let I=0;const bt=gt(e=>(Z.onStart=(t,s,r)=>{e({active:!0,item:t,loaded:s,total:r,progress:(s-I)/(r-I)*100})},Z.onLoad=()=>{e({active:!1})},Z.onError=t=>e(s=>({errors:[...s.errors,t]})),Z.onProgress=(t,s,r)=>{s===r&&(I=r),e({active:!0,item:t,loaded:s,total:r,progress:(s-I)/(r-I)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0})),L=new P;function S(e,t,s,r,o,n){const a=2*Math.PI*o/4,u=Math.max(n-2*o,0),d=Math.PI/4;L.copy(t),L[r]=0,L.normalize();const i=.5*a/(a+u),m=1-L.angleTo(e)/d;return Math.sign(L[s])===1?m*i:u/(a+u)+i+i*(1-m)}class re extends Xe{constructor(t=1,s=1,r=1,o=2,n=.1){const a=o*2+1;if(n=Math.min(t/2,s/2,r/2,n),super(1,1,1,a,a,a),this.type="RoundedBoxGeometry",this.parameters={width:t,height:s,depth:r,segments:o,radius:n},a===1)return;const u=this.toNonIndexed();this.index=null,this.attributes.position=u.attributes.position,this.attributes.normal=u.attributes.normal,this.attributes.uv=u.attributes.uv;const d=new P,i=new P,m=new P(t,s,r).divideScalar(2).subScalar(n),x=this.attributes.position.array,O=this.attributes.normal.array,b=this.attributes.uv.array,Q=x.length/6,f=new P,T=.5/a;for(let g=0,p=0;g<x.length;g+=3,p+=2)switch(d.fromArray(x,g),i.copy(d),i.x-=Math.sign(i.x)*T,i.y-=Math.sign(i.y)*T,i.z-=Math.sign(i.z)*T,i.normalize(),x[g+0]=m.x*Math.sign(d.x)+i.x*n,x[g+1]=m.y*Math.sign(d.y)+i.y*n,x[g+2]=m.z*Math.sign(d.z)+i.z*n,O[g+0]=i.x,O[g+1]=i.y,O[g+2]=i.z,Math.floor(g/Q)){case 0:f.set(1,0,0),b[p+0]=S(f,i,"z","y",n,r),b[p+1]=1-S(f,i,"y","z",n,s);break;case 1:f.set(-1,0,0),b[p+0]=1-S(f,i,"z","y",n,r),b[p+1]=1-S(f,i,"y","z",n,s);break;case 2:f.set(0,1,0),b[p+0]=1-S(f,i,"x","z",n,t),b[p+1]=S(f,i,"z","x",n,r);break;case 3:f.set(0,-1,0),b[p+0]=1-S(f,i,"x","z",n,t),b[p+1]=1-S(f,i,"z","x",n,r);break;case 4:f.set(0,0,1),b[p+0]=1-S(f,i,"x","y",n,t),b[p+1]=1-S(f,i,"y","x",n,s);break;case 5:f.set(0,0,-1),b[p+0]=S(f,i,"x","y",n,t),b[p+1]=1-S(f,i,"y","x",n,s);break}}static fromJSON(t){return new re(t.width,t.height,t.depth,t.segments,t.radius)}}const Ce=({position:e,texture:t,index:s})=>{const[r,o]=l.useState(!1),n=l.useRef(null),a=l.useMemo(()=>new P,[]),u=r?"#CBC3FF":"#FFF";l.useEffect(()=>{document.body.style.cursor=r?"url(@/icons/cursor-hand.svg) 5 5, auto":"url(@/icons/cursor-arrow.svg) 5 5, auto"},[r]),l.useEffect(()=>{a.set(e.x*2,e.y,e.z*2),n.current.lookAt(a)},[e,a]);const d=ge(),i=()=>{d(`/element/${s}`)},m=new re(1,1,1,10,.1);return c.jsx("mesh",{ref:n,geometry:m,name:(s+1).toString(),position:e,onPointerOver:()=>o(!0),onPointerOut:()=>o(!1),onDoubleClick:i,children:c.jsx("meshBasicMaterial",{toneMapped:!1,color:u,map:t})})},yt=({elements:e})=>{const{camera:t}=te(),s=ve(Me,Array.from({length:118},(a,u)=>`/textures/textures_elements_${u}.png`));let r=Math.round(118/16/2)-1,o=-8;t.position.set(0,0,-15);const n=l.useMemo(()=>{const a=[];for(let u=0;u<e.length;u++)o>8&&(r--,o=-8),a.push(c.jsx(Ce,{position:new P(o*1.8,r*2.5,0),texture:s[+e[u].atomicNumber],index:+e[u].atomicNumber},u)),o++;return a},[e,s]);return c.jsx(c.Fragment,{children:n})},vt=({elements:e})=>{const{camera:t}=te(),s=ve(Me,Array.from({length:118},(o,n)=>`/textures/textures_elements_${n}.png`));t.position.set(0,0,-15);const r=l.useMemo(()=>{const o=[];for(let n=0;n<e.length;n++){const a=n*.175+Math.PI,u=-(n*.05)+3;o.push(c.jsx(Ce,{position:new P().setFromCylindricalCoords(8,a,u),texture:s[+e[n].atomicNumber-1],index:+e[n].atomicNumber},n))}return o},[e,s]);return c.jsx(c.Fragment,{children:r})},Mt=({options:e,value:t,onChange:s,placeholder:r="Select option",id:o,className:n,disabled:a=!1})=>{const u=d=>{s(d.target.value)};return c.jsxs("select",{id:o,value:t,onChange:u,disabled:a,className:se("bg-transparent text-white px-3 py-2 rounded-lg border border-white/30 hover:border-primary focus:outline-none focus:border-primary",n),children:[r&&c.jsx("option",{value:"",disabled:!0,hidden:!0,children:r}),e.map(d=>c.jsx("option",{value:d.value,children:d.label},d.value))]})};function jt(){const{t:e}=je("filters"),t=Se(),s=k(Ie),r=k(Le),o=a=>u=>{t(Ve({key:a,value:u}))},n=()=>{t(De())};return c.jsxs("section",{className:"mb-4 md:mb-10 w-full flex justify-center px-4 gap-2 absolute bottom-0 z-2",children:[Object.entries(s).map(([a,u])=>{const d=[{value:"",label:e("buttons.resetFilter")},...u.map(i=>({value:i.value,label:e(`${a}.${i.value}`)}))];return c.jsx(Mt,{id:a,options:d,value:r[a],placeholder:e(`labels.${a}`),onChange:o(a)},a)}),c.jsx("button",{type:"button",onClick:n,className:"px-4 py-2 rounded-lg bg-primary text-white",children:e("buttons.resetFilters")})]})}const wt=we("px-4 cursor-hand select-none transition-colors text-center rounded-md",{variants:{size:{sm:"text-sm px-3 py-1.5",md:"text-base px-4 py-2",lg:"text-lg px-6 py-3"},active:{true:"bg-primary text-white",false:"bg-transparent text-white hover:bg-white/10"}},defaultVariants:{size:"md",active:!1}}),St=we("inline-flex border border-white/30 rounded-lg overflow-hidden bg-transparent"),Pt=l.forwardRef(({options:e,initialValue:t,size:s="md",className:r,onChange:o,...n},a)=>{const[u,d]=l.useState(t),i=m=>{d(m),o?.(m)};return c.jsx("div",{ref:a,className:se(St(),r),...n,children:e.map(m=>{const x=m===u;return c.jsx("button",{type:"button",onClick:()=>i(m),className:wt({size:s,active:x}),children:m},m)})})});var q=(e=>(e.Helix="Helix",e.Table="Table",e))(q||{});function Ct({value:e,onChange:t,placeholder:s="Searchâ€¦",className:r}){const o=a=>{t(a.target.value)},n=()=>{t(e)};return c.jsxs("span",{className:"flex w-full  max-w-1/3 items-center",children:[c.jsx("input",{type:"search",value:e,onChange:o,placeholder:s,className:se("px-4 py-2 rounded-lg rounded-r-none border bg-transparent text-white outline-none w-full","border-white/30 focus:border-primary",r)}),c.jsx("button",{type:"button",onClick:n,className:"px-6 py-2 rounded-lg rounded-l-none border-l-none border border-white/30 hover:border-primary bg-primary text-white",children:c.jsx(Ye,{name:et.MagnifyingGlass})})]})}const Et=[q.Helix,q.Table];function zt({onTypeChange:e}){const t=ge(),s=Se(),r=k(n=>n.search.query),{t:o}=je();return c.jsxs("header",{className:"p-4 md:px-8 flex justify-between w-full absolute z-5",children:[c.jsx(tt,{src:st,onClick:()=>t("/")}),c.jsx(Ct,{value:r,placeholder:o("search"),onChange:n=>s(Be(n)),className:"my-2"}),c.jsx(Pt,{initialValue:"Helix",options:Et,onChange:n=>e(n),className:"my-2"})]})}function Ft(){const{progress:e}=bt();return c.jsxs(xt,{center:!0,className:"text-primary text-xl",children:[Math.floor(e),"%"]})}const Tt=()=>{const[e,t]=l.useState(q.Helix),s=k(_e),r=k(Ge),o=k(Ue);return c.jsxs("div",{children:[c.jsx(zt,{type:e,onTypeChange:n=>t(n)}),c.jsx(jt,{}),s==="loading"&&c.jsx("p",{className:"text-primary m-auto",children:"Load Elements..."}),s==="failed"&&c.jsx("p",{children:r}),s==="succeeded"&&c.jsx(nt,{style:{position:"absolute",zIndex:1},children:c.jsxs(l.Suspense,{fallback:c.jsx(Ft,{}),children:[e==="Helix"&&c.jsx(vt,{elements:o}),e==="Table"&&c.jsx(yt,{elements:o}),c.jsx(rt,{minPolarAngle:Math.PI/2,maxPolarAngle:Math.PI/2}),c.jsx("ambientLight",{color:13410292,intensity:1})]})})]})};export{Tt as default};
